
<!DOCTYPE html>
<html>
<head>
    <title>Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">
    <h2>Parsed Netskope Log</h2>

    <p><strong>Hostname:</strong> {{ hostname }}</p>
    <p><strong>OS Version:</strong> {{ os_version }}</p>
    <p><strong>Client Version:</strong> {{ client_version }}</p>
    {% if tenant %}<p><strong>Tenant:</strong> {{ tenant }}</p>{% endif %}
    {% if last_gateway %}<p><strong>Last Connected Gateway:</strong> {{ last_gateway }}</p>{% endif %}
    {% if steering_modes %}
        <div class="card my-3">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#steering-modes">ðŸ”½ Traffic Steering Modes</div>
            <div id="steering-modes" class="collapse"><div class="card-body"><pre>{{ steering_modes|join('\n') }}</pre></div></div>
        </div>
    {% endif %}

    <h4 class="mt-4">Last 5 PoP Connections</h4>
    <ul>
        {% for entry in pops %}
        <li><code>{{ entry }}</code></li>
        {% endfor %}
    </ul>

    <div class="card my-4">
        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#rtt-table">ðŸ”½ RTT to PoPs</div>
        <div id="rtt-table" class="collapse"><div class="card-body">{{ rtt|safe }}</div></div>
    </div>

    <div class="card my-4">
        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#general-errors">ðŸ”½ General Errors & Warnings</div>
        <div id="general-errors" class="collapse"><div class="card-body">{{ generalerr|safe }}</div></div>
    </div>

    <h3 class="mt-4">Tunneled Processes ({{ tunneled_count }})</h3>
    {% for process, hosts in grouped_tunneled.items() %}
        <div class="card my-3">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#tun-{{ loop.index }}">ðŸ”½ {{ process }}</div>
            <div id="tun-{{ loop.index }}" class="collapse">
                <ul class="list-group list-group-flush">
                {% for host, entries in hosts.items() %}
                    <li class="list-group-item"><strong>{{ host }}</strong> ({{ entries|length }} connections)</li>
                {% endfor %}
                </ul>
            </div>
        </div>
    {% endfor %}

    <h3 class="mt-4">Bypassed Processes ({{ bypassed_count }})</h3>
    {% for process, hosts in grouped_bypassed.items() %}
        <div class="card my-3">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#byp-{{ loop.index }}">ðŸ”½ {{ process }}</div>
            <div id="byp-{{ loop.index }}" class="collapse">
                <ul class="list-group list-group-flush">
                {% for host, entries in hosts.items() %}
                    <li class="list-group-item"><strong>{{ host }}</strong> ({{ entries|length }} connections)</li>
                {% endfor %}
                </ul>
            </div>
        </div>
    {% endfor %}

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</html>
